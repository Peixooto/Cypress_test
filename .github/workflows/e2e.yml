name: Cypress E2E

on:
 push: 
  branches: [main]

jobs:
 e2e-tests:
  runs-on: ubuntu-latest

  steps: 

   - name: Checkout repository
     uses: actions/checkout@v3

   - name: Node verification
     uses: actions/setup-node@v3
     with:
      node-version: 22

   - name: Debug workspace
     run: |
        echo "Current path:"
        pwd
        echo "Files here:"
        ls -la

   - name: Dependencies check
     run: |
      npm install
      npm install cypress --save-dev

   - name: Running tests
     run: npx cypress run
     
   - uses: actions/upload-artifact@v4
     if: failure()
     with:
          name: cypress-screenshots
          path: cypress/screenshots
          if-no-files-found: ignore
   - uses: actions/upload-artifact@v4
     with:
          name: cypress-videos
          path: cypress/videos
          if-no-files-found: ignore 
